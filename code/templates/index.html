<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CyberCipher</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script>
    function showTab(tabName, firstLoad = false) {
      // éšè—æ‰€æœ‰ tab å†…å®¹
      document.querySelectorAll(".tab-content").forEach(div => div.style.display = "none");
  
      // æ˜¾ç¤ºå½“å‰é€‰ä¸­çš„ tab
      document.getElementById(tabName).style.display = "block";
  
      // æ¸…ç©ºç»“æœ/é”™è¯¯æ˜¾ç¤ºåŒºåŸŸ
      if (!firstLoad) {
        resultDiv = document.querySelector(".result");
        hintDiv = document.querySelector(".hint");
      const errorDiv = document.querySelector(".error");
      if (resultDiv) resultDiv.innerHTML = "";
      if (errorDiv) errorDiv.innerHTML = "";
      } 
    }
  
    window.onload = function () {
    //   showTab("encrypt-tab", true);
    showTab("{{ mode }}-tab", true)
    }
  </script>
  
</head>
<body>
<div class="container">

  <div class="sidebar">
    <div class="header">å·¥å…·é¢æ¿</div>
    <ul>
      <li><button onclick="showTab('encrypt-tab')">ğŸ” åŠ å¯†</button></li>
      <li><button onclick="showTab('decrypt-tab')">ğŸ”“ è§£å¯†</button></li>
      <li><button onclick="showTab('freq-tab')">ğŸ“Š é¢‘ç‡åˆ†æ</button></li>
      <li><button onclick="showTab('assist-tab')">ğŸ§  ç ´è¯‘å»ºè®®</button></li>
    </ul>
  </div>

  <div class="main">
    <div class="header">å•è¡¨ä»£æ¢è¾…åŠ©å·¥å…·</div>

    <!-- åŠ å¯†æ¨¡å— -->
    <div id="encrypt-tab" class="tab-content" style="display: none;">
      <form method="POST">
        <input type="hidden" name="mode" value="encrypt">
        <label>æ˜æ–‡ï¼š</label>
        <textarea name="text" rows="4" required>{{ request.form.text or "" }}</textarea>

        <label>å¯†é’¥ï¼ˆJSON æ ¼å¼ï¼‰ï¼šå¦‚{"a":"e","e":"c"}</label>
        <textarea name="key" rows="4" required>{{ key_raw or "" }}</textarea>

        <button type="submit">åŠ å¯†</button>
      </form>
    </div>

    <!-- è§£å¯†æ¨¡å— -->
    <div id="decrypt-tab" class="tab-content" style="display: none;">
      <form method="POST">
        <input type="hidden" name="mode" value="decrypt">
        <label>å¯†æ–‡ï¼š</label>
        <textarea name="text" rows="4" required>{{ request.form.text or "" }}</textarea>

        <label>å¯†é’¥ï¼ˆJSON æ ¼å¼ï¼‰ï¼šå¦‚{"a":"e","e":"c"}</label>
        <textarea name="key" rows="4" required>{{ key_raw or "" }}</textarea>

        <button type="submit">è§£å¯†</button>
      </form>
    </div>

    <!-- é¢‘ç‡åˆ†ææ¨¡å—ï¼ˆå ä½ï¼‰ -->
    <div id="freq-tab" class="tab-content" style="display: none;">
        <form method="POST">
          <input type="hidden" name="mode" value="freq">
      
          <label>æ–‡æœ¬ï¼š</label>
          <textarea name="text" rows="4" required>{{ request.form.text or "" }}</textarea>
      
          <label>å¯†é’¥ï¼ˆJSON æ ¼å¼ï¼‰ï¼šå¦‚{"a":"e","e":"c"}</label>
          <textarea name="key" rows="4" required>{{ key_raw or "" }}</textarea>
      
          <div style="margin-top: 10px;">
            <button name="freq_type" value="letter">å­—æ¯é¢‘ç‡</button>
            <button name="freq_type" value="bigram">Bigram</button>
            <button name="freq_type" value="trigram">Trigram</button>
            <button name="freq_type" value="word">å•è¯é¢‘ç‡</button>
          </div>
        </form>
      </div>
      

    <!-- ç ´è¯‘å»ºè®®æ¨¡å—ï¼ˆå ä½ï¼‰ -->
    <div id="assist-tab" class="tab-content" style="display: none;">
        <form method="POST" enctype="multipart/form-data">
          <input type="hidden" name="mode" value="assist">
      
          <label>æ–‡æœ¬ï¼š</label>
          <textarea name="text" rows="4" required>{{ request.form.text or "" }}</textarea>
      
          <label>å¯†é’¥ï¼ˆJSON æ ¼å¼ï¼‰ï¼šå¦‚{"a":"e","e":"c"}</label>
          <textarea name="key" rows="4" required>{{ key_raw or "" }}</textarea>
      
          <div style="margin-top: 10px;">
            
            <button name="assist_type" value="vowel">å…ƒéŸ³æ£€æŸ¥</button>
            <button name="assist_type" value="word_level">è¯é¢‘åˆ†çº§</button>
            <button name="assist_type" value="compare">å¯¹æ¯”æ¨¡å¼</button>
            <button name="assist_type" value="word_check">çŸ­è¯æ£€æŸ¥</button>
            

          </div>
      
          
        </form>
      </div>
      
      

    {% if result %}
    <div class="result"><strong>ç»“æœï¼š</strong><pre>{{ result }}</pre></div>
    <div class="hint"><strong>æç¤ºï¼š</strong>{{ hint }}</div>
    {% else %}
    {% endif %}

    {% if error %}
    <div class="error"><strong>é”™è¯¯ï¼š</strong><pre>{{ error }}</pre></div>
    {% endif %}
  </div>

</div>
</body>
</html>
